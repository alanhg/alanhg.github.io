---
title: 前端国际化文件拆分
tags:
  - react
  - react-intl
  - webpack
abbrlink: 459e5afb
date: 2019-07-24 22:33:00
---
> 前端对于静态显示的内容如标题，弹框文本等，有时需要做国际化。随着国际化的内容增多，单个文件下进行维护就显得不怎么方便。这时我们需要按照功能等拆分为多个JSON或者JS文件，这样维护性上便会提高。

拆分后的JSON文件我们希望是这样
![image](https://user-images.githubusercontent.com/9245110/61802090-7d13fa00-ae62-11e9-9478-aeb8ab29b99f.png)

如何实现呢，继续看。

## 环境
这里贴下，我实现时的环境
- React `v16.4.2`
- React-intl `v^2.7.2`
- Webpack `v4.17.1`

## 安装 merge-jsons-webpack-plugin插件
```
yarn add  merge-jsons-webpack-plugin --dev
```
## Webpack配置
```javascript
const MergeJsonWebpackPlugin = require('merge-jsons-webpack-plugin');

new MergeJsonWebpackPlugin({
      output: {
        groupBy: [
          {pattern: "./src/main/webapp/i18n/en/*.json", fileName: "./i18n/en.json"}
          // jhipster-needle-i18n-language-webpack - JHipster will add/remove languages in this array
        ]
      }
    })
```
## APP中加载
> 以下为react程序加载code,angular,vue等类似。

```typescript
export const getLocale = lang => axios.get(`/i18n/${lang}.json`);


setupAxiosInterceptors(() => (location.href = '/#/login'));
const rootEl = document.getElementById('root');
const messages = {};
const locale = 'en';
const render = () =>
  ReactDOM.render(
    <AppContainer>
      <IntlProvider locale={locale} messages={messages[locale]}>
        {
          // @ts-ignore
          <Provider store={store}>
            <AppComponent />
          </Provider>
        }
      </IntlProvider>
    </AppContainer>,
    rootEl
  );

getLocale(locale).then(res => {
  messages[locale] = res.data;
  render();
});

```
## 原理
原理简单，但还是啰嗦下，Webpack作为构建工具，将N个JSON文件合并为一个，移动到特定的路径下，而我们WEB请求了合并后的文件，从而对外是一个文件，而在维护编写层面却可以是多个。中间的构建合并交给了Webpack解决。

